(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e3c0c388"],{"406a":function(t,e,i){"use strict";i("f6a7")},f6a1:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-auth"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"redirect"},[t.token?e("h2",{staticClass:"text-center"},[t._v(" مرحبا بك: "+t._s(t.user.UsFirstName)+" ")]):t.codeAuth?e("h2",{staticClass:"text-center"},[t._v(" جاري تسجيل الدخول ... ")]):t._e()])])]),e("div",{staticClass:"modal fade",attrs:{id:"loginFailed",tabindex:"-1","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-lg modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[t._m(0),e("div",{staticClass:"modal-body"},[null!=t.loginFailed?e("h4",[t._v(" "+t._s(t.loginFailed)+" ")]):t._e(),e("a",{staticClass:"btn btn-primary",attrs:{href:"#"},on:{click:t.logoutReset}},[t._v("مــوافق")])])])])])])])},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("الدخول عبر اور")])])}],a=(i("14d9"),i("bc3a")),r=i.n(a),n=i("3d20"),u=i.n(n),c=i("2f62");const l="https://ur.gov.iq/verify-auth?",h="148",d="https://xdata.ur.gov.iq/user-auth",f="https://xdata.ur.gov.iq/api/";var g={name:"userAuth",title:"تفعيل الحساب",data(){return{urURL:l,clientID:h,clientURL:d,loginText:" باستخدام رقم الهاتف",codeAuth:null,loginFailed:null,hideErr:[],path:null,Viewid:null,TID:null}},computed:{...Object(c["c"])(["token","user","isAuth","uri"])},methods:{...Object(c["b"])(["setUserAction","setTokenAction","logoutReset","setUriAction"]),loginWithCode(t){let e=this.$loading.show({loader:"dots",transition:"fade",color:"#c30734"});if(t){if(this.isAuth)var i={Authorization:"Bearer "+this.token},s="auth/user-verification";else s="auth/citizen-verification";r.a.post(f+s,{code:t},{headers:i}).then(t=>{200==t.status&&(this.setTokenAction(t.data.access_token),this.setUserAction(t.data.userinfo),e.hide(),u.a.fire({icon:"success",title:"تمت المصادقة بنجاح",showConfirmButton:!1,timer:1700}).then(()=>{null!=this.user.OrgID?this.$router.push("/dashboard").catch():this.$router.push({path:this.uri})}))}).catch(t=>{if(e.hide(),this.hideErr.push(t),400==t.response.status)u.a.fire({icon:"warning",title:"صلاحية المصادقة منتهية",showConfirmButton:!0}).then(()=>{console.log("comeback to user auth")});else if(422==t.response.status){this.loginFailed=t.response.data.errors[0][0];let e=bootstrap.Modal.getOrCreateInstance(document.getElementById("loginFailed"));e.show()}})}else e.hide(),this.$router.push("/")}},mounted(){Object.keys(this.$route.query).includes("code")?(console.log("check code query"),this.codeAuth=this.$route.query.code,this.isAuth?0==this.user.ur_login&&this.loginWithCode(this.$route.query.code):this.isAuth||this.loginWithCode(this.$route.query.code)):Object.keys(this.$route.query).includes("uri")&&(this.setUriAction(this.$route.query.uri),this.isAuth||"babil"==this.$route.query.uri?this.$router.push({path:this.uri}):location.assign(`${this.urURL}client_id=${this.clientID}&redirect_uri=${this.clientURL}&serviceName=${this.loginText}&pNo=0`))}},v=g,p=(i("406a"),i("0c7c")),m=Object(p["a"])(v,s,o,!1,null,"27e83bfb",null);e["default"]=m.exports},f6a7:function(t,e,i){}}]);